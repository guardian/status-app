@(clusters: List[model.Cluster], totalSunkCost: Float, money: java.text.DecimalFormat)

@import model._

@main("Ophan Status", refreshSecs = Some(10)) {

<div class="container-fluid cluster-status" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">

        <div class="row">

        @for(column <- clusters.grouped(clusters.size / 3)) {

            <div class="span4 col-lg-4">
            @for(cluster <- column) {
                    <div class="header">

                    <h3>@cluster.stage: @cluster.appName</h3>

                    </div>

                    @if(!cluster.asg.suspendedActivities.isEmpty) {
                    <div class="alert">
                       <strong>Warning!</strong> The following autoscaling activities are currently
                       suspended: @cluster.asg.suspendedActivities.mkString(", ")
                    </div>
                    }

                    <table class="table">

                        <thead>
                            <th width="75px">Instance</th>
                            <th>AutoScaling Status</th>
                            @if(cluster.hasElb) {
                                <th>ELB Status</th>
                            }
                            <th width="60px">Uptime</th>
                            <th width="50px">Version</th>
                        </thead>

                    @for(member <- cluster.members) {
                      <tr class="@member.goodorbad">
                      <td><a href="@routes.Application.instance(member.id)">@member.id</a></td>
                      <td>@member.lifecycleState</td>
                      @if(cluster.hasElb) {
                      <td title="@member.description">@member.state<br>@member.description</td>
                      }
                      <td>@member.instance.uptime</td>
                      <td>@member.instance.version.getOrElse("?")</td>
                      </tr>
                    }

                    </table>

                    <div class="financial-info">Approx monthly cost: $@money.format(cluster.approxMonthlyCost)</div>

                    @if(!cluster.asg.recentActivity.isEmpty) {
                    <div id="@cluster.name-activity" class="accordion">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <a class="accordion-toggle" data-toggle="collapse" data-parent="#@cluster.name-activity" href="#@cluster.name-activity-details">
                                    Recent activity
                                </a>
                            </div>
                            <div id="@cluster.name-activity-details" class="accordion-body collapse">
                                <div class="accordion-inner">
                                @for(action <- cluster.asg.recentActivity.take(3)) {
                                    <p><strong>@action.age</strong> @action.cause</p>
                                }
                                </div>
                            </div>
                        </div>
                    </div>
                    }

                }
            </div>
        }

            <div class="span4">
                <a href="http://stats.pingdom.com/eep7lohezpmt">
                    <img src="https://share.pingdom.com/banners/618fea45"
                    alt="Uptime Report for ophan dashboard: Last 30 days"
                    title="Uptime Report for ophan dashboard: Last 30 days"
                    width="300" height="165" />
                </a>
            </div>

     </div>

    <div class="row-fluid">
        <div class="sunk span12">
            Approx total monthly cost: $@money.format(clusters.map(_.approxMonthlyCost).sum)
            (total sunk cost: $@money.format(totalSunkCost))
        </div>
    </div>



    
}